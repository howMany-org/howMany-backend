generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Game {
  id             Int               @id @default(autoincrement()) @map("id")
  title          String            @map("title")
  appId          Int               @map("app_id")
  imageHash      String?           @map("image_hash")
  mbtiGameMappings MbtiGameMapping[]  // 게임과 MBTI 매핑 관계

  @@map("game")
}

model MbtiAnswer {
  id            Int              @id @default(autoincrement()) @map("id")
  questionId    Int              @map("question_id")
  answer        String           @map("answer")
  mbtiQuestion  MbtiQuestion     @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId], name: "FK_mbti_question_TO_mbti_answer")
  @@map("mbti_answer")
}

model MbtiGameMapping {
  id           Int               @id @default(autoincrement()) @map("id")
  mbtiId       Int               @map("mbti_id")
  gameId       Int               @map("game_id")
  mbti         Mbti              @relation(fields: [mbtiId], references: [id], onDelete: Cascade)
  game         Game              @relation(fields: [gameId], references: [id], onDelete: Cascade)

  @@index([mbtiId], name: "FK_mbti_TO_mbti_game_mapping")
  @@index([gameId], name: "FK_game_TO_mbti_game_mapping")
  @@map("mbti_game_mapping")
}

model MbtiQuestion {
  id            Int              @id @default(autoincrement()) @map("id")
  question      String           @map("question")
  mbtiAnswer   MbtiAnswer[]     // MBTI 질문에 대한 답변들

  @@map("mbti_question")
}

model Mbti {
  id               Int            @id @default(autoincrement()) @map("id")
  mbtiType         String         @map("mbti_type")
  description      String         @map("description")
  mbtiGameMapping MbtiGameMapping[]  // MBTI 유형과 게임 매핑 관계

  @@map("mbti")
}

model User {
  id              Int       @id @default(autoincrement()) @map("id")
  steamId         BigInt    @map("steam_id") @unique
  steamName       String    @map("steam_name")
  steamJoinDate   DateTime  @map("steam_join_date")
  avatarHash      String?   @map("avatar_hash")
  mbtiType        String?   @map("mbti_type")

  @@map("user")
}
